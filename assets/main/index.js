window.__require=function t(e,i,s){function o(a,l){if(!i[a]){if(!e[a]){var h=a.split("/");if(h=h[h.length-1],!e[h]){var r="function"==typeof __require&&__require;if(!l&&r)return r(h,!0);if(n)return n(h,!0);throw new Error("Cannot find module '"+a+"'")}a=h}var c=i[a]={exports:{}};e[a][0].call(c.exports,function(t){return o(e[a][1][t]||t)},c,c.exports,t,e,i,s)}return i[a].exports}for(var n="function"==typeof __require&&__require,a=0;a<s.length;a++)o(s[a]);return o}({character:[function(t,e){"use strict";cc._RF.push(e,"52759OS7npEa7WhvIWu2RWR","character"),cc.Class({extends:cc.Component,properties:{moveSpeed:1,game:{default:null,type:cc.Node}},onKeyDown:function(t){switch(t.keyCode){case cc.macro.KEY.w:this.pressDown=!1,this.pressLeft=!1,this.pressRight=!1,this.pressUp=!0;break;case cc.macro.KEY.s:this.pressUp=!1,this.pressLeft=!1,this.pressRight=!1,this.pressDown=!0;break;case cc.macro.KEY.a:this.pressUp=!1,this.pressDown=!1,this.pressRight=!1,this.pressLeft=!0;break;case cc.macro.KEY.d:this.pressUp=!1,this.pressDown=!1,this.pressLeft=!1,this.pressRight=!0}},initChar:function(){this.dirChangeable=!0,this.pressUp=!1,this.pressDown=!1,this.pressLeft=!1,this.pressRight=!1,this.moveUp=!1,this.moveDown=!1,this.moveLeft=!1,this.moveRight=!1},onLoad:function(){this.boundLeft=-this.game.node.width/2+this.game.node.getComponent("utils").outlinePrefab.data.width/2+this.game.node.getComponent("utils").gapX,this.boundRight=this.game.node.width/2-this.game.node.getComponent("utils").outlinePrefab.data.width/2-this.game.node.getComponent("utils").gapX,this.boundBot=-this.game.node.height/2+this.game.node.getComponent("utils").outlinePrefab.data.height/2+this.game.node.getComponent("utils").gapY,this.boundTop=this.game.node.height/2-this.game.node.getComponent("utils").outlinePrefab.data.height/2-this.game.node.getComponent("utils").gapY,this.initChar(),this.col=this.game.startCell.x,this.row=this.game.startCell.y,this.currentCel=cc.v2(this.col,this.row),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),this.node.zIndex=2},onDestroy:function(){cc.systemEvent.off(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this)},checkMovedInCell:function(){if(this.moveUp){if(this.dirChangeable=!1,this.node.y+=this.moveSpeed,(this.col!=this.currentCel.x||this.row!=this.currentCel.y)&&this.node.y>this.currentCelY)return this.node.y=this.currentCelY,this.dirChangeable=!0,this.currentCel=cc.v2(this.col,this.row),cc.v2(this.currentCelX,this.currentCelY)}else if(this.moveDown){if(this.dirChangeable=!1,this.node.y-=this.moveSpeed,(this.col!=this.currentCel.x||this.row!=this.currentCel.y)&&this.node.y<this.currentCelY)return this.node.y=this.currentCelY,this.dirChangeable=!0,this.currentCel=cc.v2(this.col,this.row),cc.v2(this.currentCelX,this.currentCelY)}else if(this.moveRight){if(this.dirChangeable=!1,this.node.x+=this.moveSpeed,(this.col!=this.currentCel.x||this.row!=this.currentCel.y)&&this.node.x>this.currentCelX)return this.node.x=this.currentCelX,this.dirChangeable=!0,this.currentCel=cc.v2(this.col,this.row),cc.v2(this.currentCelX,this.currentCelY)}else if(this.moveLeft&&(this.dirChangeable=!1,this.node.x-=this.moveSpeed,(this.col!=this.currentCel.x||this.row!=this.currentCel.y)&&this.node.x<this.currentCelX))return this.node.x=this.currentCelX,this.dirChangeable=!0,this.currentCel=cc.v2(this.col,this.row),cc.v2(this.currentCelX,this.currentCelY);return null},checkHitObstacle:function(t){for(var e=0;e<t.length;e++)if(t[e].x==this.node.x&&t[e].y==this.node.y)return e;return null},checkHitCapturedCell:function(t){if(null!=this.capturedCell&&(this.col!=this.capturedCell.x||this.row!=this.capturedCell.y))for(var e=0;e<t.length;e++)if(t[e].x==this.node.x&&t[e].y==this.node.y)return e;return null},updateCapturedCell:function(){this.capturedCell=cc.v2(this.col,this.row)},resetCapturedCell:function(){this.capturedCell=cc.v2(-1,-1)},update:function(){this.col=Math.ceil((this.node.x+this.game.node.width/2)/this.game.node.getComponent("utils").outlinePrefab.data.width),this.row=Math.ceil((this.node.y+this.game.node.height/2)/this.game.node.getComponent("utils").outlinePrefab.data.height),this.currentCelX=this.col*this.game.node.getComponent("utils").outlinePrefab.data.width+this.game.node.getComponent("utils").gapX-this.game.node.getComponent("utils").outlinePrefab.data.width/2-this.game.node.width/2,this.currentCelY=this.row*this.game.node.getComponent("utils").outlinePrefab.data.height+this.game.node.getComponent("utils").gapY-this.game.node.getComponent("utils").outlinePrefab.data.height/2-this.game.node.height/2,this.node.x<this.boundLeft?cc.director.loadScene("GameOver"):this.node.x>this.boundRight?cc.director.loadScene("GameOver"):this.node.y<this.boundBot?cc.director.loadScene("GameOver"):this.node.y>this.boundTop?cc.director.loadScene("GameOver"):this.game.winGoal.x!=this.node.x||this.game.winGoal.y!=this.node.y?this.dirChangeable&&(this.pressUp?(this.moveUp=!0,this.moveDown=!1,this.moveLeft=!1,this.moveRight=!1):this.pressDown?(this.moveUp=!1,this.moveDown=!0,this.moveLeft=!1,this.moveRight=!1):this.pressLeft?(this.moveUp=!1,this.moveDown=!1,this.moveLeft=!0,this.moveRight=!1):this.pressRight&&(this.moveUp=!1,this.moveDown=!1,this.moveLeft=!1,this.moveRight=!0)):cc.director.loadScene("Win")}}),cc._RF.pop()},{}],continue_button:[function(t,e){"use strict";cc._RF.push(e,"6fbfdFVwi1KQ5W6GnjRqeoj","continue_button"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){var t=cc.find("background");this.node.on("touchstart",function(){cc.director.loadScene("Stage_0"+(t.stage+1)),cc.game.removePersistRootNode(t)},this.node),this.node.on("touchmove",function(t){var e=t.touch.getDelta();this.x+=e.x,this.y+=e.y},this.node),this.node.on("touchend",function(){},this.node)},start:function(){}}),cc._RF.pop()},{}],gameover:[function(t,e){"use strict";cc._RF.push(e,"3fc962FZCJA76m6EIXt0srR","gameover"),cc.Class({extends:cc.Component,properties:{stageScene:cc.SceneAsset},onLoad:function(){},start:function(){}}),cc._RF.pop()},{}],sound_lib_ts:[function(t,e,i){"use strict";cc._RF.push(e,"9c2faOaXvZPD4ZL8MSnrffs","sound_lib_ts"),Object.defineProperty(i,"__esModule",{value:!0});var s=cc._decorator,o=s.ccclass,n=s.property,a=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.audioTestDisplay=null,e.seamlessAudioList=[],e.fadeAudioList=[],e.fps=0,e.frameCount=0,e.totalVolume=0,e.audioList=[],e}return __extends(e,t),e.prototype.onLoad=function(){this.SeamlessAudio=cc.Class({properties:{clip:cc.AudioClip,id:0,startBuffer:0,endBuffer:0},getId:function(){return this.id},setId:function(t){this.id=t},getStartBuffer:function(){return this.startBuffer},setStartBuffer:function(t){this.startBuffer=t},getEndBuffer:function(){return this.endBuffer},setEndBuffer:function(t){this.endBuffer=t}}),this.FadeAudio=cc.Class({properties:{id:0,fadeRate:0,endVolume:0,fadeCheckTime:0,endTime:0},getId:function(){return this.id},setId:function(t){this.id=t},getFadeRate:function(){return this.fadeRate},setFadeRate:function(t){this.fadeRate=t},getEndVolume:function(){return this.endVolume},setEndVolume:function(t){this.endVolume=t},getFadeCheckTime:function(){return this.fadeCheckTime},setFadeCheckTime:function(t){this.fadeCheckTime=t},getEndTime:function(){return this.endTime},setEndTime:function(t){this.endTime=t}}),this.startTime=(new Date).getTime(),cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.resources.load("Sounds/spark_man",function(t,e){self.clip_1=e}),cc.resources.load("Sounds/Loop",function(t,e){self.clip_2=e}),this.markerTest=!1,this.totalLimiter(-2)},e.prototype.limiter=function(t,e,i){var s=document.createElement("audio");s.src=t.nativeUrl;var o=new AudioContext,n=o.createMediaElementSource(s),a=o.createGain(),l=o.createDynamicsCompressor();l.threshold.value=i,l.knee.value=0,l.ratio.value=20,l.attack.value=.005,l.release.value=.05,n.connect(a),a.connect(l),l.connect(o.destination),i/=20;var h=Math.pow(10,i);return console.log("New volume: "+h),h<e?h:e>1?1:e},e.prototype.totalLimiter=function(t){t/=20,this.totalVolume=Math.pow(10,t),console.log("Limiter: "+this.totalVolume)},e.prototype.setLimiterAuto=function(){if(this.totalVolume>0&&this.audioList.length>0){this.totalVolume/=this.audioList.length;for(var t=0,e=0;e<this.audioList.length;e++)1==cc.audioEngine.getState(e)&&(t+=cc.audioEngine.getVolume(e));console.log("Original total volume: "+t);var i=this.totalVolume/t;for(console.log("Rate: "+i),e=0;e<this.audioList.length;e++){console.log("Old volume "+e+" : "+cc.audioEngine.getVolume(e));var s=cc.audioEngine.getVolume(e)*i;s<cc.audioEngine.getVolume(e)&&cc.audioEngine.setVolume(this.audioList[e],s),console.log("New volume "+e+" : "+cc.audioEngine.getVolume(e))}this.totalVolume*=this.audioList.length}},e.prototype.play=function(t,e,i,s){if(0==this.totalVolume)return cc.audioEngine.play(t,e,this.limiter(t,i,s));var o=cc.audioEngine.play(t,e,this.limiter(t,i,s));return this.audioList.push(o),o},e.prototype.getFormat=function(t){return t.nativeUrl.substr(t.nativeUrl.length-3,3).toLowerCase()},e.prototype.playSeamlessAudio=function(t,e,i){e/=1e3,i/=1e3;var s=new this.SeamlessAudio;s.setId(t),s.setStartBuffer(e),s.setEndBuffer(i),this.seamlessAudioList.push(s)},e.prototype.seamlessProcess=function(){for(var t=0;t<this.seamlessAudioList.length;t++)cc.audioEngine.isLoop(this.seamlessAudioList[t].getId())&&1==cc.audioEngine.getState(this.seamlessAudioList[t].getId())&&cc.audioEngine.getCurrentTime(this.seamlessAudioList[t].getId())>cc.audioEngine.getDuration(this.seamlessAudioList[t].getId())-this.seamlessAudioList[t].getEndBuffer()&&cc.audioEngine.setCurrentTime(this.seamlessAudioList[t].getId(),this.seamlessAudioList[t].getStartBuffer())},e.prototype.playFadeAudio=function(t,e,i,s){if(this.fps>0){var o=1e3*(cc.audioEngine.getDuration(t)-cc.audioEngine.getCurrentTime(t));(0==s||o<s)&&(s=o),cc.audioEngine.setVolume(t,e);var n=new this.FadeAudio;n.setId(t),n.setEndVolume(i),n.setFadeCheckTime((new Date).getTime()),n.setEndTime(n.getFadeCheckTime()+s),this.updateFadeRate(n),this.fadeAudioList.push(n)}},e.prototype.updateFadeRate=function(t){var e=(t.getEndTime()-(new Date).getTime())/1e3*this.fps,i=t.getEndVolume()-cc.audioEngine.getVolume(t.getId());t.setFadeRate(i/e)},e.prototype.fadeProcess=function(){for(var t=0;t<this.fadeAudioList.length;t++)if(cc.audioEngine.getVolume(this.fadeAudioList[t].getId())!=this.fadeAudioList[t].getEndVolume()){if(this.fadeAudioList[t].getFadeRate()>0){if(cc.audioEngine.getVolume(this.fadeAudioList[t].getId())>this.fadeAudioList[t].getEndVolume()){cc.audioEngine.setVolume(this.fadeAudioList[t].getId(),this.fadeAudioList[t].getEndVolume());continue}}else if(this.fadeAudioList[t].getFadeRate()<0&&cc.audioEngine.getVolume(this.fadeAudioList[t].getId())<this.fadeAudioList[t].getEndVolume()){cc.audioEngine.setVolume(this.fadeAudioList[t].getId(),this.fadeAudioList[t].getEndVolume());continue}this.updateFadeRate(this.fadeAudioList[t]),cc.audioEngine.setVolume(this.fadeAudioList[t].getId(),cc.audioEngine.getVolume(this.fadeAudioList[t].getId())+this.fadeAudioList[t].getFadeRate())}},e.prototype.getFPS=function(){(new Date).getTime()-this.startTime>=1e3&&(this.fps=this.frameCount,this.frameCount=0,this.startTime=(new Date).getTime()),this.frameCount+=1},e.prototype.markerToTimeInSec=function(t){var e=t.split(":"),i=0,s=0,o=0,n=0;return 4==e.length?(i=parseInt(e[0]),s=parseInt(e[1]),o=parseInt(e[2]),n=parseInt(e[3])):3==e.length?(s=parseInt(e[0]),o=parseInt(e[1]),n=parseInt(e[2])):2==e.length?(o=parseInt(e[0]),n=parseInt(e[1])):1==e.length&&(n=parseInt(e[0])),3600*i+60*s+o+n/1e3},e.prototype.playAtMarker=function(t,e){cc.audioEngine.setCurrentTime(t,this.markerToTimeInSec(e))},e.prototype.getCurrentTimeMarker=function(t){var e=cc.audioEngine.getCurrentTime(t),i=Math.floor(e/3600),s=Math.floor(e/60);s>59&&(s=59);var o=Math.floor(e-3600*i-60*s),n=e-Math.floor(e);return(n*=1e3)>999&&(n=999),i+":"+s+":"+o+":"+Math.round(n)},e.prototype.onKeyDown=function(t){switch(t.keyCode){case cc.macro.KEY.q:this.markerTest=!1,cc.audioEngine.stopAll(),this.id=this.play(self.clip_2,!0,1,0),this.playSeamlessAudio(this.id,0,0),console.log("Normal loop"),this.audioTestDisplay.string="Normal loop";break;case cc.macro.KEY.w:this.markerTest=!1,cc.audioEngine.stopAll(),this.id=this.play(self.clip_2,!0,1,0),this.playSeamlessAudio(this.id,0,0),console.log("Seamless loop"),this.audioTestDisplay.string="Seamless loop";break;case cc.macro.KEY.e:this.markerTest=!1,cc.audioEngine.stopAll(),this.id=this.play(self.clip_1,!0,1,0),this.playFadeAudio(this.id,0,1,2e4),console.log("Fade in"),this.audioTestDisplay.string="Fade in in 20 secs";break;case cc.macro.KEY.r:this.markerTest=!1,cc.audioEngine.stopAll(),this.id=this.play(self.clip_1,!0,1,0),this.playFadeAudio(this.id,1,0,15e3),console.log("Fade out"),this.audioTestDisplay.string="Fade out in 15 secs";break;case cc.macro.KEY.t:this.markerTest=!1,cc.audioEngine.stopAll(),this.id=this.play(self.clip_1,!0,1,0),this.playAtMarker(this.id,"0:1:2:0"),console.log("Play at 0:1:2:0"),this.audioTestDisplay.string="Play audio at 0:1:2:0";break;case cc.macro.KEY.y:this.markerTest=!1,cc.audioEngine.stopAll(),this.id=this.play(self.clip_1,!0,1,0),this.playAtMarker(this.id,"0:2:5:50"),console.log("Play at 0:2:5:50"),this.audioTestDisplay.string="Play audio at 0:2:5:50";break;case cc.macro.KEY.u:this.markerTest=!1,cc.audioEngine.stopAll(),this.play(self.clip_1,!0,1,-2),this.playAtMarker(this.play(self.clip_1,!0,.5,-2),"0:2:5:50"),this.playAtMarker(this.play(self.clip_1,!0,.5,-2),"0:0:55:50"),console.log("Limiter"),this.audioTestDisplay.string="Limiter";break;case cc.macro.KEY.i:if(this.markerTest)e=this.getCurrentTimeMarker(this.id),console.log("Playing at "+e),this.audioTestDisplay.string="Playing at "+e;else{cc.audioEngine.stopAll(),this.id=this.play(self.clip_1,!0,1,-2);var e=this.getCurrentTimeMarker(this.id);console.log("Playing at "+e),this.audioTestDisplay.string="Playing at "+e,this.markerTest=!0}}},e.prototype.update=function(){this.getFPS(),this.seamlessProcess(),this.fadeProcess(),this.setLimiterAuto()},__decorate([n(cc.Label)],e.prototype,"audioTestDisplay",void 0),__decorate([o],e)}(cc.Component);i.default=a,cc._RF.pop()},{}],sound_lib:[function(t,e){"use strict";cc._RF.push(e,"0a228QCnPxFUKKZybvIrMTt","sound_lib"),cc.Class({extends:cc.Component,properties:{audioTestDisplay:{default:null,type:cc.Label}},onLoad:function(){this.seamlessAudioList=[],this.SeamlessAudio=cc.Class({properties:{audio:null,startBuffer:0,endBuffer:0},getAudio:function(){return this.audio},setAudio:function(t){this.audio=t},getStartBuffer:function(){return this.startBuffer},setStartBuffer:function(t){this.startBuffer=t},getEndBuffer:function(){return this.endBuffer},setEndBuffer:function(t){this.endBuffer=t}}),this.fadeAudioList=[],this.FadeAudio=cc.Class({properties:{audio:null,fadeRate:0,endVolume:0,fadeCheckTime:0,endTime:0},getAudio:function(){return this.audio},setAudio:function(t){this.audio=t},getAudioSrc:function(){return this.audio.getAudio()},getFadeRate:function(){return this.fadeRate},setFadeRate:function(t){this.fadeRate=t},getEndVolume:function(){return this.endVolume},setEndVolume:function(t){this.endVolume=t},getFadeCheckTime:function(){return this.fadeCheckTime},setFadeCheckTime:function(t){this.fadeCheckTime=t},getEndTime:function(){return this.endTime},setEndTime:function(t){this.endTime=t}}),this.LimiterAudio=cc.Class({properties:{id:0,limitDBFS:0,maxPCM:-999,audio:null,fading:!1},getId:function(){return this.id},setId:function(t){this.id=t},getLimitDBFS:function(){return this.limitDBFS},setLimitDBFS:function(t){this.limitDBFS=t},getMaxPCM:function(){return this.maxPCM},setMaxPCM:function(t){this.maxPCM=t},getAudio:function(){return this.audio},setAudio:function(t){this.audio=t},isFading:function(){return this.fading},setFading:function(t){this.fading=t}}),this.playingList=[],this.startTime=(new Date).getTime(),this.fps=0,this.frameCount=0,this.totalVolume=0,this.totalLimiter=-999,this.audioList=[],this.limitRate=0,cc.systemEvent.on(cc.SystemEvent.EventType.KEY_DOWN,this.onKeyDown,this),cc.resources.load("Sounds/spark_man",function(t,e){self.clip_1=e}),cc.resources.load("Sounds/Loop",function(t,e){self.clip_2=e}),cc.resources.load("Sounds/shadow_man",function(t,e){self.clip_3=e}),cc.resources.load("Sounds/spark_mandrill",function(t,e){self.clip_4=e}),cc.resources.load("Sounds/MP3/Intro_A",function(t,e){self.Intro_A=e}),cc.resources.load("Sounds/MP3/Intro_B",function(t,e){self.Intro_B=e}),cc.resources.load("Sounds/MP3/Loop",function(t,e){self.Loop=e}),cc.resources.load("Sounds/MP3/Outro_A",function(t,e){self.Outro_A=e}),cc.resources.load("Sounds/MP3/Outro_B",function(t,e){self.Outro_B=e}),cc.resources.load("Sounds/MP3/Outro_B_Test",function(t,e){self.Outro_B_Test=e}),cc.resources.load("Sounds/MP3/Outro_C_Test",function(t,e){self.Outro_C_Test=e}),this.markerTest=!1,this.fade="",this.checkMarker="",this.step=-1,this.scenario="",this.gameCallMarker=0},setTotalLimiter:function(t,e){this.totalLimiter=t,this.limitRate=e},getTotalLimiter:function(){return this.totalLimiter},setLimiterAuto:function(){if(this.playingList.length>0)if(this.totalLimiter>-999){for(var t=0,e=0,i=0;i<this.playingList.length;i++)!this.playingList[i].getAudio().paused&&this.playingList[i].getAudio().currentTime>0&&!this.playingList[i].isFading()&&(t+=this.playingList[i].getMaxPCM(),e+=1);if(0==e)return;var s=-999;0!=t&&(s=20*Math.log10(t*Math.sqrt(2)));var o=0;if(s-.8*e>this.totalLimiter)for(var n=0;n<this.playingList.length;n++)!this.playingList[n].getAudio().paused&&this.playingList[n].getAudio().currentTime>0&&(o=this.playingList[n].getAudio().volume-this.limitRate)>0&&(this.playingList[n].getAudio().volume=o)}else for(var a=0;a<this.playingList.length;a++)if(!this.playingList[a].getAudio().paused&&this.playingList[a].getAudio().currentTime>0&&!this.playingList[a].isFading()&&20*Math.log10(this.playingList[a].getMaxPCM()*Math.sqrt(2))-.8>this.playingList[a].getLimitDBFS()){var l=this.playingList[a].getAudio().volume-=this.limitRate;l>0&&(this.playingList[a].getAudio().volume=l)}},play:function(t,e,i,s){var o,n=new AudioContext,a=t.nativeUrl,l=new Audio(a),h=n.createScriptProcessor(2048,1,1);l.addEventListener("canplaythrough",function(){null==o&&((o=n.createMediaElementSource(l)).connect(h),o.connect(n.destination),h.connect(n.destination),l.loop=e)},!1),l.volume=i,l.play();var r=new this.LimiterAudio;return r.setId(this.playingList.length),r.setAudio(l),r.setLimitDBFS(s),this.playingList.push(r),this.getFormat(r.getId()),h.onaudioprocess=function(t){var e=t.inputBuffer.getChannelData(0),i=e.length,s=null,o=Math.abs(e[0]);null==s&&(s=r);for(var n=0;n<i;n++)Math.abs(e[n])>o&&(o=Math.abs(e[n]));s.setMaxPCM(o)},r.getId()},pause:function(t){this.playingList[t].getAudio().pause()},uncacheAll:function(){for(var t=0;t<this.playingList.length;t++)this.playingList[t].getAudio().pause(),this.playingList[t].getAudio().currentTime=0;this.playingList=[],this.seamlessAudioList=[],this.fadeAudioList=[]},getFormat:function(t){var e=this.playingList[t].getAudio().src;return e.substr(e.length-3,3).toLowerCase()},playSeamlessAudio:function(t,e,i){e/=1e3,i/=1e3;var s=new this.SeamlessAudio;s.setAudio(this.playingList[t].getAudio()),s.setStartBuffer(e),s.setEndBuffer(i),this.seamlessAudioList.push(s),this.playingList[t].currentTime=e},seamlessProcess:function(){for(var t=0;t<this.seamlessAudioList.length;t++)this.seamlessAudioList[t].getAudio().loop&&!this.seamlessAudioList[t].getAudio().paused&&this.seamlessAudioList[t].getAudio().currentTime>this.seamlessAudioList[t].getAudio().duration-this.seamlessAudioList[t].getEndBuffer()&&(this.seamlessAudioList[t].getAudio().currentTime=this.seamlessAudioList[t].getStartBuffer())},playFadeAudio:function(t,e,i,s){if(this.fps>0){this.playingList[t].setFading(!0),this.playingList[t].getAudio().volume=e;var o=new this.FadeAudio;o.setAudio(this.playingList[t]),o.setEndVolume(i),o.setFadeCheckTime((new Date).getTime());var n=1e3*(o.getAudioSrc().duration-o.getAudioSrc().currentTime);!this.playingList[t].getAudio().loop&&(0==s||n<s)&&(s=n),o.setEndTime(o.getFadeCheckTime()+s),this.updateFadeRate(o),this.fadeAudioList.push(o)}},updateFadeRate:function(t){var e=(t.getEndTime()-(new Date).getTime())/1e3*this.fps,i=t.getEndVolume()-t.getAudioSrc().volume;t.setFadeRate(i/e)},fadeProcess:function(){for(var t=0;t<this.fadeAudioList.length;t++)if(this.fadeAudioList[t].getAudioSrc().volume!=this.fadeAudioList[t].getEndVolume()){this.updateFadeRate(this.fadeAudioList[t]);var e=this.fadeAudioList[t].getAudioSrc().volume+this.fadeAudioList[t].getFadeRate();this.fadeAudioList[t].getFadeRate()>0?e>this.fadeAudioList[t].getEndVolume()&&(e=this.fadeAudioList[t].getEndVolume()):this.fadeAudioList[t].getFadeRate()<0&&e<this.fadeAudioList[t].getEndVolume()&&(e=this.fadeAudioList[t].getEndVolume()),this.fadeAudioList[t].getAudioSrc().volume=e,this.fadeAudioList[t].getAudioSrc().volume==this.fadeAudioList[t].getEndVolume()&&(this.fadeAudioList[t].getAudio().setFading(!1),this.fadeAudioList.splice(t,1),t--)}this.fadeAudioList.length>0&&("in"==this.fade?this.audioTestDisplay.string="Fade in in "+Math.round(this.idleTime(this.id,2e4,0)/1e3)+" secs":"out"==this.fade&&(this.audioTestDisplay.string="Fade out in "+Math.round(this.idleTime(this.id,15e3,0)/1e3)+" secs"))},getFPS:function(){(new Date).getTime()-this.startTime>=1e3&&(this.fps=this.frameCount,this.frameCount=0,this.startTime=(new Date).getTime()),this.frameCount+=1},markerToTimeInSec:function(t){var e=t.split(":"),i=0,s=0,o=0,n=0;return 4==e.length?(i=parseInt(e[0]),s=parseInt(e[1]),o=parseInt(e[2]),n=parseInt(e[3])):3==e.length?(s=parseInt(e[0]),o=parseInt(e[1]),n=parseInt(e[2])):2==e.length?(o=parseInt(e[0]),n=parseInt(e[1])):1==e.length&&(n=parseInt(e[0])),3600*i+60*s+o+n/1e3},playAtMarker:function(t,e){this.playingList[t].getAudio().currentTime=this.markerToTimeInSec(e)},getCurrentTimeMarker:function(t){var e=this.playingList[t].getAudio().currentTime;return this.timeInSecToMarker(e)},timeInSecToMarker:function(t){var e=Math.floor(t/3600),i=Math.floor(t/60);i>59&&(i=59);var s=Math.floor(t-3600*e-60*i),o=t-Math.floor(t);return(o*=1e3)>999&&(o=999),e+":"+i+":"+s+":"+Math.round(o)},onKeyDown:function(t){switch(t.keyCode){case cc.macro.KEY.q:if(this.fade="",this.markerTest=!1,this.scenario="",this.totalVolume=0,this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.id=this.play(self.clip_2,!0,1,0),this.playSeamlessAudio(this.id,0,0),console.log("Normal loop"),this.audioTestDisplay.string="Normal loop";break;case cc.macro.KEY.w:if(this.fade="",this.markerTest=!1,this.scenario="",this.totalVolume=0,this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.id=this.play(self.clip_2,!0,1,0),this.playSeamlessAudio(this.id,50,50),console.log("Seamless loop"),this.audioTestDisplay.string="Seamless loop";break;case cc.macro.KEY.e:if(this.fade="in",this.markerTest=!1,this.scenario="",this.totalVolume=0,this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.id=this.play(self.clip_1,!0,1,0),this.playFadeAudio(this.id,0,1,2e4),this.gameCallMarker=(new Date).getTime(),console.log("Fade in");break;case cc.macro.KEY.r:if(this.fade="out",this.markerTest=!1,this.scenario="",this.totalVolume=0,this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.id=this.play(self.clip_1,!0,1,0),this.playFadeAudio(this.id,1,0,15e3),this.gameCallMarker=(new Date).getTime(),console.log("Fade out");break;case cc.macro.KEY.t:if(this.fade="",this.markerTest=!1,this.scenario="",this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.setTotalLimiter(-5,.02),this.play(self.clip_1,!0,1,0),this.play(self.clip_2,!0,1,0),this.playAtMarker(this.play(self.clip_3,!0,1,0),"0:2:5:50"),this.playAtMarker(this.play(self.clip_4,!0,1,0),"0:0:55:50"),this.playAtMarker(this.play(self.clip_1,!0,1,0),"0:0:55:50"),console.log("Limiter at -5 dBFS"),this.audioTestDisplay.string="Limiter at -5 dBFS";break;case cc.macro.KEY.y:if(this.fade="",this.markerTest=!1,this.scenario="",this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.setTotalLimiter(0,.02),this.play(self.clip_1,!0,1,0),this.play(self.clip_2,!0,1,0),this.playAtMarker(this.play(self.clip_3,!0,1,0),"0:2:5:50"),this.playAtMarker(this.play(self.clip_4,!0,1,0),"0:0:55:50"),this.playAtMarker(this.play(self.clip_1,!0,1,0),"0:0:55:50"),console.log("Limiter at 0 dBFS"),this.audioTestDisplay.string="Limiter at 0 dBFS";break;case cc.macro.KEY.u:if(this.fade="",this.markerTest=!1,this.scenario="",this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.setTotalLimiter(-2,.02),this.play(self.clip_1,!0,1,0),this.play(self.clip_2,!0,1,0),this.playAtMarker(this.play(self.clip_3,!0,1,0),"0:2:5:50"),this.playAtMarker(this.play(self.clip_4,!0,1,0),"0:0:55:50"),this.playAtMarker(this.play(self.clip_1,!0,1,0),"0:0:55:50"),console.log("Limiter at -2 dBFS"),this.audioTestDisplay.string="Limiter at -2 dBFS";break;case cc.macro.KEY.i:if(this.fade="",this.totalVolume=0,this.scenario="",this.markerTest){var e=this.getCurrentTimeMarker(this.id);console.log("Playing at "+e),this.audioTestDisplay.string="Playing at "+e}else{if(this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.id=this.play(self.clip_1,!0,1,-2);var i=this.getCurrentTimeMarker(this.id);console.log("Playing at "+i),this.audioTestDisplay.string="Playing at "+i,this.markerTest=!0}break;case cc.macro.KEY.o:if(this.fade="",this.markerTest=!1,this.totalVolume=0,"A"!=this.scenario&&(this.step=-1),this.scenario="A",this.step<0||5==this.step){if(this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.step=0}else 2==this.step&&(this.gameCallMarker=this.getCurrentTimeMarker(this.id),this.nextBeatInMilSec=this.displayNextBeat=this.getNextBeatInMilSec(this.id,this.gameCallMarker,444.444,1),this.step+=1);break;case cc.macro.KEY.p:if(this.fade="",this.markerTest=!1,this.totalVolume=0,"B"!=this.scenario&&(this.step=-1),this.scenario="B",this.step<0||5==this.step){if(this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.step=0,this.nextBeatInMilSec=0}else 2==this.step&&(this.pause(this.preId),this.gameCallMarker=this.getCurrentTimeMarker(this.id),this.nextBeatInMilSec=this.displayNextBeat=this.getNextBeatInMilSec(this.id,this.gameCallMarker,444.444,1),this.step+=1);break;case cc.macro.KEY.l:if(this.fade="",this.markerTest=!1,this.totalVolume=0,"C"!=this.scenario&&(this.step=-1),this.scenario="C",this.step<0||4==this.step){if(this.playingList.length>0){this.uncacheAll(),this.audioTestDisplay.string="Uncached all";break}this.step=0}else 1==this.step&&(this.gameCallMarker=this.getCurrentTimeMarker(this.id),this.nextBeatInMilSec=this.displayNextBeat=this.getNextBeatWithAlign(this.id,this.gameCallMarker,"0:0:0:573",444.444),this.nextBeatAfterGCInMilSec=this.getNextBeatInMilSec(this.id,this.gameCallMarker,444.444,1),this.triggerPoint=this.nextBeatInMilSec-573,this.step+=1)}},compareTime:function(t,e,i){return e-t<i},getNextBeatInMilSec:function(t,e,i,s){var o=1e3*this.playingList[t].getAudio().duration,n=1e3*this.markerToTimeInSec(e);this.compareTime(n,o,100)&&(n-=100);var a=Math.floor(n/i),l=Math.ceil(o/i)-a-s;return 0==l?o:l>0?i*(a+s):i*l},getNextBeatWithAlign:function(t,e,i,s){var o=this.getNextBeatInMilSec(t,e,s,1),n=1e3*this.markerToTimeInSec(i),a=1e3*this.markerToTimeInSec(e);if(n>s)for(;o-n<a;)o+=s;return o},idleTime:function(t,e,i){var s=e-1e3*this.playingList[t].getAudio().currentTime;return s<=i&&(this.nextBeatInMilSec=0),s<0&&(s=0),s},scenarioA:function(){"A"==this.scenario&&(0==this.step?(this.nextBeatInMilSec=0,this.id=this.play(self.Intro_A,!1,1,0),this.preId=this.id,this.step+=1):1==this.step?(this.checkMarker=this.getCurrentTimeMarker(this.id),this.compareTime(1e3*this.markerToTimeInSec(this.checkMarker),1e3*this.playingList[this.id].getAudio().duration,120)&&(this.pause(this.id),this.id=this.play(self.Loop,!0,1,0),this.playSeamlessAudio(this.id,0,50),this.step+=1),this.audioTestDisplay.string="Scenario A: Intro A at "+this.getCurrentTimeMarker(this.id)):2==this.step?(this.checkMarker=this.getCurrentTimeMarker(this.id),this.audioTestDisplay.string="Scenario A: Loop at "+this.checkMarker):3==this.step?this.nextBeatInMilSec>0?this.audioTestDisplay.string="Scenario A: Loop at "+this.getCurrentTimeMarker(this.id)+"\nGame call detected at "+this.gameCallMarker+" and Outro A triggers on next beat "+this.timeInSecToMarker(this.nextBeatInMilSec/1e3)+"\nWaiting until next beat after "+this.idleTime(this.id,this.nextBeatInMilSec,50)+" secs":(this.pause(this.id),this.id=this.play(self.Outro_A,!1,1,0),this.playingList[this.id].getAudio().currentTime=.04,this.step+=1):4==this.step&&(this.audioTestDisplay.string="Scenario A: Outro A at "+this.getCurrentTimeMarker(this.id)+"\nGame call detected at "+this.gameCallMarker+" and Outro A triggered on next beat "+this.timeInSecToMarker(this.displayNextBeat/1e3),this.playingList[this.id].getAudio().paused&&this.playingList[this.id].getAudio().currentTime>=this.playingList[this.id].getAudio().duration&&(this.step+=1)))},scenarioB:function(){"B"==this.scenario&&(0==this.step?(this.nextBeatInMilSec=0,this.id=this.play(self.Intro_B,!1,1,0),this.step+=1):1==this.step?(0==this.nextBeatInMilSec&&(this.nextBeatInMilSec=this.getNextBeatInMilSec(this.id,"0:0:0:0",573,1)),this.compareTime(1e3*this.playingList[this.id].getAudio().currentTime,this.nextBeatInMilSec,120)&&(this.preId=this.id,this.id=this.play(self.Loop,!0,1,0),this.playSeamlessAudio(this.id,0,50),this.nextBeatInMilSec=0,this.step+=1),this.audioTestDisplay.string="Scenario B: Intro B at "+this.getCurrentTimeMarker(this.id)+"\nLoop triggers on next beat "+this.timeInSecToMarker(this.nextBeatInMilSec/1e3)):2==this.step?(this.checkMarker=this.getCurrentTimeMarker(this.id),this.compareTime(1e3*this.playingList[this.preId].getAudio().currentTime,1e3*this.playingList[this.preId].getAudio().duration,.5)?this.audioTestDisplay.string="Scenario B: Loop at "+this.checkMarker:this.audioTestDisplay.string="Scenario B: Intro B at "+this.getCurrentTimeMarker(this.preId)+"\nLoop at "+this.checkMarker):3==this.step?this.nextBeatInMilSec>0?this.audioTestDisplay.string="Scenario A: Loop at "+this.getCurrentTimeMarker(this.id)+"\nGame call detected at "+this.gameCallMarker+" and Outro B triggers on next beat "+this.timeInSecToMarker(this.nextBeatInMilSec/1e3)+"\nWaiting until next beat after "+this.idleTime(this.id,this.nextBeatInMilSec,50)+" secs":(this.preId=this.id,this.id=this.play(self.Outro_B_Test,!1,1,0),this.playFadeAudio(this.preId,this.playingList[this.preId].getAudio().volume,0,888),this.step+=1):4==this.step&&(this.playingList[this.preId].getAudio().volume>0?this.audioTestDisplay.string="Scenario B: Loop at "+this.getCurrentTimeMarker(this.preId)+" fading out until marker (0:0:0:888) of Outro B\nScenario B: Outro B at "+this.getCurrentTimeMarker(this.id)+"\nGame call detected at "+this.gameCallMarker+" and Outro B triggered on next beat "+this.timeInSecToMarker(this.displayNextBeat/1e3):(this.playingList[this.preId].getAudio().paused||(this.pause(this.preId),this.playingList[this.preId].getAudio().currentTime=0),this.audioTestDisplay.string="Loop finished fading out at marker (0:0:0:888)\nScenario B: Outro B at "+this.getCurrentTimeMarker(this.id)+"\nGame call detected at "+this.gameCallMarker+" and Outro B triggered on next beat "+this.timeInSecToMarker(this.displayNextBeat/1e3)),this.playingList[this.id].getAudio().paused&&this.playingList[this.id].getAudio().currentTime>=this.playingList[this.id].getAudio().duration&&(this.step+=1)))},scenarioC:function(){"C"==this.scenario&&(0==this.step?(this.nextBeatInMilSec=0,this.id=this.play(self.Loop,!0,1,0),this.playSeamlessAudio(this.id,0,50),this.step+=1):1==this.step?this.audioTestDisplay.string="Scenario C: Loop at "+this.getCurrentTimeMarker(this.id):2==this.step?this.nextBeatInMilSec>0?this.audioTestDisplay.string="Scenario C: Loop at "+this.getCurrentTimeMarker(this.id)+"\nGame call detected at "+this.gameCallMarker+" and Outro C triggers at "+this.timeInSecToMarker(this.triggerPoint/1e3)+"\nWaiting until Outro C triggers after "+this.idleTime(this.id,this.triggerPoint,50)+" secs":(this.preId=this.id,this.id=this.play(self.Outro_C_Test,!1,1,0),this.playFadeAudio(this.preId,this.playingList[this.preId].getAudio().volume,0,573),this.step+=1):3==this.step&&(this.playingList[this.preId].getAudio().volume>0?this.audioTestDisplay.string="Scenario C: Loop at "+this.getCurrentTimeMarker(this.preId)+" fading out until next "+(Math.round((this.displayNextBeat-this.nextBeatAfterGCInMilSec)/444.444)+1)+" beat(s) "+this.timeInSecToMarker(this.displayNextBeat/1e3)+"\nScenario C: Outro C at "+this.getCurrentTimeMarker(this.id)+"\nGame call detected at "+this.gameCallMarker+" and Outro C triggered at "+this.timeInSecToMarker(this.triggerPoint/1e3):(this.playingList[this.preId].getAudio().paused||(this.pause(this.preId),this.playingList[this.preId].getAudio().currentTime=0),this.audioTestDisplay.string="Loop finished fading out after "+(Math.round((this.displayNextBeat-this.nextBeatAfterGCInMilSec)/444.444)+1)+" beat(s) "+this.timeInSecToMarker(this.displayNextBeat/1e3)+"\nScenario C: Outro B at "+this.getCurrentTimeMarker(this.id)+"\nGame call detected at "+this.gameCallMarker+" and Outro C triggered at "+this.timeInSecToMarker(this.triggerPoint/1e3)),this.playingList[this.id].getAudio().paused&&this.playingList[this.id].getAudio().currentTime>=this.playingList[this.id].getAudio().duration&&(this.step+=1)))},update:function(){this.getFPS(),this.seamlessProcess(),this.fadeProcess(),this.setLimiterAuto(),this.scenarioA(),this.scenarioB(),this.scenarioC()}}),cc._RF.pop()},{}],stage_01:[function(t,e){"use strict";cc._RF.push(e,"fe62esqIT1NuJH8BnGJbNtJ","stage_01"),cc.Class({extends:cc.Component,properties:{background:{default:null,stage:0,score:0,totalScore:0,type:cc.Node},flowerPrefab:{default:null,type:cc.Prefab},fencePrefab:{default:null,type:cc.Prefab},winGoal:{default:null,type:cc.Node},character:{default:null,type:cc.Node}},onLoad:function(){cc.game.addPersistRootNode(this.background),this.background.zIndex=-1,this.background.stage=1,this.player=this.character.getComponent("character"),this.character.getComponent("character").game=this;var t=this.node.getComponent("utils").outlinePool.size();this.flowerPool=new cc.NodePool;for(var e=0;e<t;e++){var i=cc.instantiate(this.flowerPrefab);this.flowerPool.put(i)}var s=-1;this.map=[s,s,1,1,1,1,1,1,1,1,1,1,1,1,1,1,s,s,s,s,s,s,s,s,s,s,1,s,s,s,s,s,s,s,s,s,s,s,s,s,1,s,s,s,s,1,s,s,s,s,s,s,s,s,s,s,s,s,s,1,s,s,s,1,1,s,1,1,1,1,1,1,1,1,s,s,s,s,1,s,s,s,s,1,s,s,s,s,s,s,s,1,1,s,s,s,s,1,1,1,1,s,1,s,s,s,s,s,s,s,1,1,s,s,s,s,s,s,s,1,s,1,s,2,s,s,s,s,s,1,1,s,s,1,1,1,1,s,1,s,1,s,s,s,s,s,s,s,1,1,s,s,s,s,s,s,s,1,s,1,1,1,1,1,1,1,1,1,1,s,s,s,s,s,s,s,1,s,s,s,s,s,s,s,s,s,s,1,1,s,s,s,s,s,s,1,s,s,s,s,1,1,1,1,s,s,s,s,s,0,s,s,s,s,1,s,s,s,s,1,1,1,1,s,s,s,s,s],this.flowerPos=[],this.fencePos=[];for(var o=this.node.getComponent("utils").rowCount,n=this.node.getComponent("utils").colCount,a=0,l=0;l<this.map.length;l++)l==a+n&&(o-=1,a+=n),0==this.map[l]?this.startCell=cc.v2(l+1-a,o):1==this.map[l]?this.fencePos.push(cc.v2(l+1-a,o)):2==this.map[l]&&this.winGoal.setPosition(this.node.getComponent("utils").getCellPos(l+1-a,o));this.fencePool=new cc.NodePool;for(var h=0;h<this.fencePos.length;h++)this.fencePos[h]=this.node.getComponent("utils").createObstacle(this.node,this.fencePos[h],this.fencePrefab,this.fencePool,!0);var r=this.node.getComponent("utils").getCellPos(this.startCell.x,this.startCell.y);this.player.node.setPosition(r),this.background.score=this.node.getComponent("utils").putObj(this.node,r,this.flowerPrefab,this.flowerPool,this.flowerPos,null),this.background.totalScore=this.node.getComponent("utils").totalScore},start:function(){},update:function(){var t=this.player.checkMovedInCell();null==this.player.checkHitCapturedCell(this.flowerPos)&&null==this.player.checkHitObstacle(this.fencePos)?null!=t&&(this.background.score=this.node.getComponent("utils").putObj(this.node,t,this.flowerPrefab,this.flowerPool,this.flowerPos,this.player)):cc.director.loadScene("GameOver")}}),cc._RF.pop()},{}],stage_02:[function(t,e){"use strict";cc._RF.push(e,"9f568r/ZNJGUr7VpNV88MMP","stage_02"),cc.Class({extends:cc.Component,properties:{background:{default:null,stage:0,score:0,totalScore:0,type:cc.Node},flowerPrefab:{default:null,type:cc.Prefab},fencePrefab:{default:null,type:cc.Prefab},grassPrefab:{default:null,type:cc.Prefab},winGoal:{default:null,type:cc.Node},character:{default:null,type:cc.Node}},onLoad:function(){cc.game.addPersistRootNode(this.background),this.background.zIndex=-1,this.background.stage=2,this.player=this.character.getComponent("character"),this.character.getComponent("character").game=this;var t=this.node.getComponent("utils").outlinePool.size();this.flowerPool=new cc.NodePool;for(var e=0;e<t;e++){var i=cc.instantiate(this.flowerPrefab);this.flowerPool.put(i)}var s=-1;this.map=[0,s,s,s,s,s,1,s,s,s,s,s,s,s,s,s,s,s,s,s,s,1,1,1,s,1,s,2,s,s,s,s,s,1,1,1,1,s,1,1,1,1,s,s,1,s,1,1,1,1,1,1,s,s,s,s,s,s,s,s,s,s,2,1,s,2,s,s,s,s,s,s,2,1,1,1,s,s,2,s,s,1,s,s,s,s,1,s,s,2,s,s,s,s,s,2,s,s,1,1,1,1,s,s,s,s,s,s,s,s,s,s,s,s,1,1,s,s,s,2,1,s,s,3,1,1,1,1,1,s,1,1,1,2,1,s,s,s,s,1,1,1,1,s,s,s,s,s,s,s,s,1,2,1,s,s,s,s,s,s,1,1,s,s,s,s,s,s,s,s,1,1,1,s,s,s,s,s,s,1,1,1,1,1,s,s,s,s,2,2,s,s,s,s,1,2,2,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,s,1,1,1,s,s,s,s,s,s,1,1,s,s,s,s],this.flowerPos=[],this.fencePos=[],this.grassPos=[];for(var o=this.node.getComponent("utils").rowCount,n=this.node.getComponent("utils").colCount,a=0,l=0;l<this.map.length;l++)l==a+n&&(o-=1,a+=n),0==this.map[l]?this.startCell=cc.v2(l+1-a,o):1==this.map[l]?this.fencePos.push(cc.v2(l+1-a,o)):2==this.map[l]?this.grassPos.push(cc.v2(l+1-a,o)):3==this.map[l]&&this.winGoal.setPosition(this.node.getComponent("utils").getCellPos(l+1-a,o));this.fencePool=new cc.NodePool;for(var h=0;h<this.fencePos.length;h++)this.fencePos[h]=this.node.getComponent("utils").createObstacle(this.node,this.fencePos[h],this.fencePrefab,this.fencePool,!0);this.grassPool=new cc.NodePool;for(var r=0;r<this.grassPos.length;r++)this.grassPos[r]=this.node.getComponent("utils").createObstacle(this.node,this.grassPos[r],this.grassPrefab,this.grassPool,!0);var c=this.node.getComponent("utils").getCellPos(this.startCell.x,this.startCell.y);this.player.node.setPosition(c),this.background.score=this.node.getComponent("utils").putObj(this.node,c,this.flowerPrefab,this.flowerPool,this.flowerPos,null),this.background.totalScore=this.node.getComponent("utils").totalScore},start:function(){},update:function(){var t=this.player.checkMovedInCell();null==this.player.checkHitCapturedCell(this.flowerPos)&&null==this.player.checkHitObstacle(this.fencePos)&&null==this.player.checkHitObstacle(this.grassPos)?null!=t&&(this.background.score=this.node.getComponent("utils").putObj(this.node,t,this.flowerPrefab,this.flowerPool,this.flowerPos,this.player)):cc.director.loadScene("GameOver")}}),cc._RF.pop()},{}],stage_03:[function(t,e){"use strict";cc._RF.push(e,"4c03cOA6b5NwJrEBCeAe5V5","stage_03"),cc.Class({extends:cc.Component,properties:{background:{default:null,stage:0,score:0,totalScore:0,type:cc.Node},flowerPrefab:{default:null,type:cc.Prefab},fencePrefab:{default:null,type:cc.Prefab},grassPrefab:{default:null,type:cc.Prefab},sheepPrefab:{default:null,type:cc.Prefab},winGoal:{default:null,type:cc.Node},character:{default:null,type:cc.Node}},onLoad:function(){cc.game.addPersistRootNode(this.background),this.background.zIndex=-1,this.background.stage=3,this.player=this.character.getComponent("character"),this.character.getComponent("character").game=this;var t=this.node.getComponent("utils").outlinePool.size();this.flowerPool=new cc.NodePool;for(var e=0;e<t;e++){var i=cc.instantiate(this.flowerPrefab);this.flowerPool.put(i)}var s=-1;this.map=[s,s,s,1,s,s,s,s,s,1,s,s,s,s,s,s,s,s,s,s,2,s,1,s,1,1,1,s,1,s,s,s,s,s,1,1,1,s,s,s,s,1,s,1,1,1,s,1,1,1,1,1,s,1,s,s,s,s,s,s,1,s,2,s,s,s,s,s,s,s,1,s,s,s,3,s,s,1,s,s,3,s,s,s,s,s,s,s,s,1,1,s,s,s,2,s,1,1,1,s,s,s,3,s,0,s,s,s,1,s,s,1,s,s,s,1,1,1,s,s,2,s,s,s,s,1,1,1,s,2,s,s,s,s,s,1,1,1,1,1,1,1,1,1,1,1,1,s,s,3,s,s,2,s,1,1,s,s,s,s,s,s,s,s,s,s,s,4,s,s,s,s,s,1,1,s,s,s,s,3,s,s,s,1,1,s,s,s,s,s,s,1,1,s,s,1,1,1,s,s,s,s,1,1,s,s,s,s,s,s,s,s,s,1,1,1,1,s,s,s,s,1,1,s,s,2,s,s],this.flowerPos=[],this.fencePos=[],this.grassPos=[],this.sheepPos=[];for(var o=this.node.getComponent("utils").rowCount,n=this.node.getComponent("utils").colCount,a=0,l=0;l<this.map.length;l++)l==a+n&&(o-=1,a+=n),0==this.map[l]?this.startCell=cc.v2(l+1-a,o):1==this.map[l]?this.fencePos.push(cc.v2(l+1-a,o)):2==this.map[l]?this.grassPos.push(cc.v2(l+1-a,o)):3==this.map[l]?this.sheepPos.push(cc.v2(l+1-a,o)):4==this.map[l]&&this.winGoal.setPosition(this.node.getComponent("utils").getCellPos(l+1-a,o));this.fencePool=new cc.NodePool;for(var h=0;h<this.fencePos.length;h++)this.fencePos[h]=this.node.getComponent("utils").createObstacle(this.node,this.fencePos[h],this.fencePrefab,this.fencePool,!0);this.grassPool=new cc.NodePool;for(var r=0;r<this.grassPos.length;r++)this.grassPos[r]=this.node.getComponent("utils").createObstacle(this.node,this.grassPos[r],this.grassPrefab,this.grassPool,!0);this.sheepIndexList=[],this.sheepPool=new cc.NodePool;for(var c=0;c<this.sheepPos.length;c++)this.sheepPos[c]=this.node.getComponent("utils").createObj(this.node,this.sheepPos[c],this.sheepPrefab,this.sheepPool,!0),this.sheepIndexList.push(this.node.getComponent("utils").objCollection.length-1);var d=this.node.getComponent("utils").getCellPos(this.startCell.x,this.startCell.y);this.player.node.setPosition(d),this.background.score=this.node.getComponent("utils").putObj(this.node,d,this.flowerPrefab,this.flowerPool,this.flowerPos,null),this.background.totalScore=this.node.getComponent("utils").totalScore,this.hitSheep=!1},start:function(){},update:function(){var t=this.player.checkMovedInCell();if(null==this.player.checkHitCapturedCell(this.flowerPos))if(null==this.player.checkHitObstacle(this.fencePos))if(null==this.player.checkHitObstacle(this.grassPos)){var e=this.player.checkHitObstacle(this.sheepPos);if(null!=e)return this.sheepPos.splice(e,1),this.node.getComponent("utils").objCollection[this.sheepIndexList[e]].removeFromParent(!0),this.hitSheep=!0,void this.sheepIndexList.splice(e,1);null!=t?this.hitSheep||(this.background.score=this.node.getComponent("utils").putObj(this.node,t,this.flowerPrefab,this.flowerPool,this.flowerPos,this.player)):this.hitSheep=!1}else cc.director.loadScene("GameOver");else cc.director.loadScene("GameOver");else cc.director.loadScene("GameOver")}}),cc._RF.pop()},{}],stage_04:[function(t,e){"use strict";cc._RF.push(e,"39f4bizjyRE3b7P1Wzb+TSU","stage_04"),cc.Class({extends:cc.Component,properties:{background:{default:null,stage:0,score:0,totalScore:0,type:cc.Node},snowFlakePrefab:{default:null,type:cc.Prefab},iglooPrefab:{default:null,type:cc.Prefab},iceSkatePrefab:{default:null,type:cc.Prefab},snowballPrefab:{default:null,orgPos:0,type:cc.Prefab},winGoal:{default:null,type:cc.Node},character:{default:null,type:cc.Node}},onLoad:function(){cc.game.addPersistRootNode(this.background),this.background.zIndex=-1,this.background.stage=4,this.player=this.character.getComponent("character"),this.character.getComponent("character").game=this;var t=this.node.getComponent("utils").outlinePool.size();this.snowFlakePool=new cc.NodePool;for(var e=0;e<t;e++){var i=cc.instantiate(this.snowFlakePrefab);this.snowFlakePool.put(i)}var s=-1;this.map=[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,s,s,2,2,2,2,2,2,2,2,2,2,2,2,2,s,s,s,s,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,s,s,s,s,s,s,2,2,2,2,2,2,2,s,s,s,s,s,s,s,s,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,s,s,2,2,2,s,2,2,2,s,s,2,2,2,s,s,s,s,s,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,s,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,s,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,s,s,2,2,2,2,2,2,s,s,2,2,2,2,2,2,s,s,2,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,3,s,2,2,2,2,2,2,s,s,s,s,2,2,2,2,2,2,2],this.snowFlakePos=[],this.iglooPos=[],this.iceSkatePos=[],this.snowballPos=[cc.v2(7,15),cc.v2(7,22),cc.v2(12,18),cc.v2(12,26),cc.v2(16,20),cc.v2(16,30)];for(var o=this.node.getComponent("utils").rowCount,n=this.node.getComponent("utils").colCount,a=0,l=0;l<this.map.length;l++)l==a+n&&(o-=1,a+=n),0==this.map[l]?this.startCell=cc.v2(l+1-a,o):1==this.map[l]?this.iglooPos.push(cc.v2(l+1-a,o)):2==this.map[l]?this.iceSkatePos.push(cc.v2(l+1-a,o)):3==this.map[l]&&this.winGoal.setPosition(this.node.getComponent("utils").getCellPos(l+1-a,o));this.iglooPool=new cc.NodePool;for(var h=0;h<this.iglooPos.length;h++)this.iglooPos[h]=this.node.getComponent("utils").createObstacle(this.node,this.iglooPos[h],this.iglooPrefab,this.iglooPool,!0);this.iceSkatePool=new cc.NodePool;for(var r=0;r<this.iceSkatePos.length;r++)this.iceSkatePos[r]=this.node.getComponent("utils").createObstacle(this.node,this.iceSkatePos[r],this.iceSkatePrefab,this.iceSkatePool,!0);this.snowballIndexList=[],this.snowballPool=new cc.NodePool;for(var c=0;c<this.snowballPos.length;c++)this.snowballPos[c]=this.node.getComponent("utils").createObj(this.node,this.snowballPos[c],this.snowballPrefab,this.snowballPool,!0),this.snowballIndexList.push(this.node.getComponent("utils").objCollection.length-1),this.node.getComponent("utils").objCollection[this.node.getComponent("utils").objCollection.length-1].orgPos=this.snowballPos[c].y,this.node.getComponent("utils").objCollection[this.node.getComponent("utils").objCollection.length-1].zIndex=4;var d=this.node.getComponent("utils").getCellPos(this.startCell.x,this.startCell.y);this.player.node.setPosition(d),this.background.score=this.node.getComponent("utils").putObj(this.node,d,this.snowFlakePrefab,this.snowFlakePool,this.snowFlakePos,null),this.background.totalScore=this.node.getComponent("utils").totalScore,this.spdUpAmount=1,this.spdUp=!1,this.snowballSpd=1,this.maxSnowballPerCol=2},start:function(){},update:function(){var t=this.player.checkMovedInCell();if(null==this.player.checkHitCapturedCell(this.snowFlakePos))if(null==this.player.checkHitObstacle(this.iglooPos)){if(null!=t){if(this.spdUp){for(var e=0;e<this.iceSkatePos.length;e++)if(this.iceSkatePos[e].x==t.x&&this.iceSkatePos[e].y==t.y)return;this.player.moveSpeed-=this.spdUpAmount,this.spdUp=!1}else for(var i=0;i<this.iceSkatePos.length;i++)if(this.iceSkatePos[i].x==t.x&&this.iceSkatePos[i].y==t.y)return this.player.moveSpeed+=this.spdUpAmount,this.spdUp=!0,void this.player.resetCapturedCell();this.background.score=this.node.getComponent("utils").putObj(this.node,t,this.snowFlakePrefab,this.snowFlakePool,this.snowFlakePos,this.player)}for(var s=0;s<this.snowballIndexList.length;s++){var o=this.snowballIndexList[0]+s;if(this.node.getComponent("utils").checkCollapsed(this.player,this.node.getComponent("utils").objCollection[o],this.player.node.width/2+this.snowballPrefab.data.width/2-15))return void cc.director.loadScene("GameOver");if((s+1)%this.maxSnowballPerCol==0&&this.node.getComponent("utils").objCollection[o].y<-this.node.height/2-this.snowballPrefab.data.height/2)for(var n=0;n<this.maxSnowballPerCol;n++)this.node.getComponent("utils").objCollection[o-n].y=this.node.getComponent("utils").objCollection[o-n].orgPos;this.node.getComponent("utils").objCollection[o].y-=this.snowballSpd}}else cc.director.loadScene("GameOver");else cc.director.loadScene("GameOver")}}),cc._RF.pop()},{}],stage_05:[function(t,e){"use strict";cc._RF.push(e,"4b569GcxL1DSZ/Kq7gyTXMb","stage_05"),cc.Class({extends:cc.Component,properties:{background:{default:null,stage:0,score:0,totalScore:0,type:cc.Node},snowFlakePrefab:{default:null,type:cc.Prefab},iglooPrefab:{default:null,type:cc.Prefab},iceSkatePrefab:{default:null,type:cc.Prefab},snowballPrefab:{default:null,orgPos:0,dir:1,type:cc.Prefab},winGoal:{default:null,type:cc.Node},character:{default:null,type:cc.Node}},onLoad:function(){cc.game.addPersistRootNode(this.background),this.background.zIndex=-1,this.background.stage=5,this.player=this.character.getComponent("character"),this.character.getComponent("character").game=this;var t=this.node.getComponent("utils").outlinePool.size();this.snowFlakePool=new cc.NodePool;for(var e=0;e<t;e++){var i=cc.instantiate(this.snowFlakePrefab);this.snowFlakePool.put(i)}var s=-1;this.map=[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,s,s,s,2,s,s,s,2,s,s,s,2,s,s,s,2,s,s,s,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,s,s,2,2,2,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,s,2,1,1,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,1,1,1,2,1,2,1,1,1,2,1,1,1,2,1,1,1,2,s,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,s,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,2,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,2,3,s,s,2,s,s,s,2,s,s,s,2,s,s,s,2,s,s,2],this.snowFlakePos=[],this.iglooPos=[],this.iceSkatePos=[],this.snowballPos=[cc.v2(-5,11),cc.v2(25,9),cc.v2(-5,7),cc.v2(25,5),cc.v2(-5,3),cc.v2(25,1)];for(var o=this.node.getComponent("utils").rowCount,n=this.node.getComponent("utils").colCount,a=0,l=0;l<this.map.length;l++)l==a+n&&(o-=1,a+=n),0==this.map[l]?this.startCell=cc.v2(l+1-a,o):1==this.map[l]?this.iglooPos.push(cc.v2(l+1-a,o)):2==this.map[l]?this.iceSkatePos.push(cc.v2(l+1-a,o)):3==this.map[l]&&this.winGoal.setPosition(this.node.getComponent("utils").getCellPos(l+1-a,o));this.iglooPool=new cc.NodePool;for(var h=0;h<this.iglooPos.length;h++)this.iglooPos[h]=this.node.getComponent("utils").createObstacle(this.node,this.iglooPos[h],this.iglooPrefab,this.iglooPool,!0);this.iceSkatePool=new cc.NodePool;for(var r=0;r<this.iceSkatePos.length;r++)this.iceSkatePos[r]=this.node.getComponent("utils").createObstacle(this.node,this.iceSkatePos[r],this.iceSkatePrefab,this.iceSkatePool,!0);this.snowballIndexList=[],this.snowballPool=new cc.NodePool;for(var c=1,d=0;d<this.snowballPos.length;d++)this.snowballPos[d]=this.node.getComponent("utils").createObj(this.node,this.snowballPos[d],this.snowballPrefab,this.snowballPool,!0),this.snowballIndexList.push(this.node.getComponent("utils").objCollection.length-1),this.node.getComponent("utils").objCollection[this.node.getComponent("utils").objCollection.length-1].orgPos=this.snowballPos[d].x,this.node.getComponent("utils").objCollection[this.node.getComponent("utils").objCollection.length-1].dir=c,this.node.getComponent("utils").objCollection[this.node.getComponent("utils").objCollection.length-1].zIndex=4,c*=-1;var u=this.node.getComponent("utils").getCellPos(this.startCell.x,this.startCell.y);this.player.node.setPosition(u),this.background.score=this.node.getComponent("utils").putObj(this.node,u,this.snowFlakePrefab,this.snowFlakePool,this.snowFlakePos,null),this.background.totalScore=this.node.getComponent("utils").totalScore,this.spdUpAmount=1,this.spdUp=!1,this.snowballSpd=2.5},start:function(){},update:function(){var t=this.player.checkMovedInCell();if(null==this.player.checkHitCapturedCell(this.snowFlakePos))if(null==this.player.checkHitObstacle(this.iglooPos)){if(null!=t){if(this.spdUp){for(var e=0;e<this.iceSkatePos.length;e++)if(this.iceSkatePos[e].x==t.x&&this.iceSkatePos[e].y==t.y)return;this.player.moveSpeed-=this.spdUpAmount,this.spdUp=!1}else for(var i=0;i<this.iceSkatePos.length;i++)if(this.iceSkatePos[i].x==t.x&&this.iceSkatePos[i].y==t.y)return this.player.moveSpeed+=this.spdUpAmount,this.spdUp=!0,void this.player.resetCapturedCell();this.background.score=this.node.getComponent("utils").putObj(this.node,t,this.snowFlakePrefab,this.snowFlakePool,this.snowFlakePos,this.player)}for(var s=0;s<this.snowballIndexList.length;s++){var o=this.snowballIndexList[0]+s;if(this.node.getComponent("utils").checkCollapsed(this.player,this.node.getComponent("utils").objCollection[o],this.player.node.width/2+this.snowballPrefab.data.width/2-15))return void cc.director.loadScene("GameOver");-1==this.node.getComponent("utils").objCollection[o].dir?this.node.getComponent("utils").objCollection[o].x<-this.node.width/2-this.snowballPrefab.data.width/2&&(this.node.getComponent("utils").objCollection[o].x=this.node.getComponent("utils").objCollection[o].orgPos):this.node.getComponent("utils").objCollection[o].x>this.node.width/2+this.snowballPrefab.data.width/2&&(this.node.getComponent("utils").objCollection[o].x=this.node.getComponent("utils").objCollection[o].orgPos),this.node.getComponent("utils").objCollection[o].x+=this.snowballSpd*this.node.getComponent("utils").objCollection[o].dir}}else cc.director.loadScene("GameOver");else cc.director.loadScene("GameOver")}}),cc._RF.pop()},{}],stage_06:[function(t,e){"use strict";cc._RF.push(e,"f71a6lysIRMHr3C9vXaUGNW","stage_06"),cc.Class({extends:cc.Component,properties:{background:{default:null,stage:0,score:0,totalScore:0,type:cc.Node},snowFlakePrefab:{default:null,type:cc.Prefab},iglooPrefab:{default:null,type:cc.Prefab},iceSkatePrefab:{default:null,type:cc.Prefab},snowballPrefab:{default:null,orgPos:0,dir:1,type:cc.Prefab},winGoal:{default:null,type:cc.Node},character:{default:null,type:cc.Node}},onLoad:function(){cc.game.addPersistRootNode(this.background),this.background.zIndex=-1,this.background.stage=6,this.player=this.character.getComponent("character"),this.character.getComponent("character").game=this;var t=this.node.getComponent("utils").outlinePool.size();this.snowFlakePool=new cc.NodePool;for(var e=0;e<t;e++){var i=cc.instantiate(this.snowFlakePrefab);this.snowFlakePool.put(i)}var s=-1;this.map=[0,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,s,2,2,2,2,s,s,s,s,s,s,s,s,2,2,1,s,s,s,1,s,1,1,s,1,s,1,1,2,1,s,1,1,2,1,s,1,s,1,s,1,1,s,1,2,1,1,2,1,2,1,1,2,1,s,1,s,1,s,s,s,s,1,2,2,2,2,s,2,2,2,2,2,2,s,s,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,1,1,1,s,1,1,1,s,1,1,1,s,1,1,1,s,1,1,2,s,s,1,2,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,2,s,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,2,1,s,s,1,s,1,s,1,s,1,s,1,s,1,s,1,s,1,s,1,s,1,1,2,1,1,1,2,1,1,1,2,1,1,1,2,1,1,2,s,s,2,2,s,s,s,2,2,s,s,s,2,2,s,s,s,s,3],this.snowFlakePos=[],this.iglooPos=[],this.iceSkatePos=[],this.snowballPos_1=[cc.v2(3.5,15),cc.v2(3.5,22),cc.v2(3.5,29),cc.v2(8.5,15),cc.v2(8.5,22),cc.v2(8.5,29),cc.v2(13.5,15),cc.v2(13.5,22),cc.v2(13.5,29),cc.v2(18.5,15),cc.v2(18.5,22),cc.v2(18.5,29)],this.snowballPos_2=[cc.v2(22,3)];for(var o=this.node.getComponent("utils").rowCount,n=this.node.getComponent("utils").colCount,a=0,l=0;l<this.map.length;l++)l==a+n&&(o-=1,a+=n),0==this.map[l]?this.startCell=cc.v2(l+1-a,o):1==this.map[l]?this.iglooPos.push(cc.v2(l+1-a,o)):2==this.map[l]?this.iceSkatePos.push(cc.v2(l+1-a,o)):3==this.map[l]&&this.winGoal.setPosition(this.node.getComponent("utils").getCellPos(l+1-a,o));this.iglooPool=new cc.NodePool;for(var h=0;h<this.iglooPos.length;h++)this.iglooPos[h]=this.node.getComponent("utils").createObstacle(this.node,this.iglooPos[h],this.iglooPrefab,this.iglooPool,!0);this.iceSkatePool=new cc.NodePool;for(var r=0;r<this.iceSkatePos.length;r++)this.iceSkatePos[r]=this.node.getComponent("utils").createObstacle(this.node,this.iceSkatePos[r],this.iceSkatePrefab,this.iceSkatePool,!0);this.snowballIndexList_1=[],this.snowballPool=new cc.NodePool;for(var c=0;c<this.snowballPos_1.length;c++)this.snowballPos_1[c]=this.node.getComponent("utils").createObj(this.node,this.snowballPos_1[c],this.snowballPrefab,this.snowballPool,!0),this.snowballIndexList_1.push(this.node.getComponent("utils").objCollection.length-1),this.node.getComponent("utils").objCollection[this.node.getComponent("utils").objCollection.length-1].orgPos=this.snowballPos_1[c].y,this.node.getComponent("utils").objCollection[this.node.getComponent("utils").objCollection.length-1].zIndex=4;this.snowballIndexList_2=[];for(var d=0;d<this.snowballPos_2.length;d++)this.snowballPos_2[d]=this.node.getComponent("utils").createObj(this.node,this.snowballPos_2[d],this.snowballPrefab,this.snowballPool,!0),this.snowballIndexList_2.push(this.node.getComponent("utils").objCollection.length-1),this.node.getComponent("utils").objCollection[this.node.getComponent("utils").objCollection.length-1].orgPos=this.snowballPos_2[d].x,this.node.getComponent("utils").objCollection[this.node.getComponent("utils").objCollection.length-1].dir=-1,this.node.getComponent("utils").objCollection[this.node.getComponent("utils").objCollection.length-1].zIndex=4;var u=this.node.getComponent("utils").getCellPos(this.startCell.x,this.startCell.y);this.player.node.setPosition(u),this.background.score=this.node.getComponent("utils").putObj(this.node,u,this.snowFlakePrefab,this.snowFlakePool,this.snowFlakePos,null),this.background.totalScore=this.node.getComponent("utils").totalScore,this.spdUpAmount=1,this.spdUp=!1,this.snowballSpd=2.5,this.maxSnowballPerCol=3},start:function(){},update:function(){var t=this.player.checkMovedInCell();if(null==this.player.checkHitCapturedCell(this.snowFlakePos))if(null==this.player.checkHitObstacle(this.iglooPos)){if(null!=t){if(this.spdUp){for(var e=0;e<this.iceSkatePos.length;e++)if(this.iceSkatePos[e].x==t.x&&this.iceSkatePos[e].y==t.y)return;this.player.moveSpeed-=this.spdUpAmount,this.spdUp=!1}else for(var i=0;i<this.iceSkatePos.length;i++)if(this.iceSkatePos[i].x==t.x&&this.iceSkatePos[i].y==t.y)return this.player.moveSpeed+=this.spdUpAmount,this.spdUp=!0,void this.player.resetCapturedCell();this.background.score=this.node.getComponent("utils").putObj(this.node,t,this.snowFlakePrefab,this.snowFlakePool,this.snowFlakePos,this.player)}for(var s=0;s<this.snowballIndexList_1.length;s++){var o=this.snowballIndexList_1[0]+s;if(this.node.getComponent("utils").checkCollapsed(this.player,this.node.getComponent("utils").objCollection[o],this.player.node.width/2+this.snowballPrefab.data.width/2-15))return void cc.director.loadScene("GameOver");if((s+1)%this.maxSnowballPerCol==0&&this.node.getComponent("utils").objCollection[o].y<-this.node.height/2-this.snowballPrefab.data.height/2)for(var n=0;n<this.maxSnowballPerCol;n++)this.node.getComponent("utils").objCollection[o-n].y=this.node.getComponent("utils").objCollection[o-n].orgPos;this.node.getComponent("utils").objCollection[o].y-=this.snowballSpd}for(var a=0;a<this.snowballIndexList_2.length;a++){var l=this.snowballIndexList_2[0]+a;if(this.node.getComponent("utils").checkCollapsed(this.player,this.node.getComponent("utils").objCollection[l],this.player.node.width/2+this.snowballPrefab.data.width/2-15))return void cc.director.loadScene("GameOver");-1==this.node.getComponent("utils").objCollection[l].dir?this.node.getComponent("utils").objCollection[l].x<-this.node.width/2-this.snowballPrefab.data.width/2&&(this.node.getComponent("utils").objCollection[l].x=this.node.getComponent("utils").objCollection[l].orgPos):this.node.getComponent("utils").objCollection[l].x>this.node.width/2+this.snowballPrefab.data.width/2&&(this.node.getComponent("utils").objCollection[l].x=this.node.getComponent("utils").objCollection[l].orgPos),this.node.getComponent("utils").objCollection[l].x+=(this.snowballSpd+1)*this.node.getComponent("utils").objCollection[l].dir}}else cc.director.loadScene("GameOver");else cc.director.loadScene("GameOver")}}),cc._RF.pop()},{}],try_again_button:[function(t,e){"use strict";cc._RF.push(e,"f3f0eyy+UpCZYkbNUx+p+8q","try_again_button"),cc.Class({extends:cc.Component,properties:{},onLoad:function(){var t=cc.find("background");this.node.on("touchstart",function(){cc.director.loadScene("Stage_0"+t.stage),cc.game.removePersistRootNode(t)},this.node),this.node.on("touchmove",function(t){var e=t.touch.getDelta();this.x+=e.x,this.y+=e.y},this.node),this.node.on("touchend",function(){},this.node)},start:function(){}}),cc._RF.pop()},{}],tutorial_button:[function(t,e){"use strict";cc._RF.push(e,"492a6Z5BnBJe54liizQyoTQ","tutorial_button"),cc.Class({extends:cc.Component,properties:{tutorial_0:{default:null,isActive:!0,type:cc.Node},tutorial_1:{default:null,isActive:!1,type:cc.Node}},onLoad:function(){this.tutorial_1.active=!1;var t=this,e=!1;this.node.on("touchstart",function(){e?cc.director.loadScene("Stage_01"):(t.tutorial_1.active=t.tutorial_1.isActive=!t.tutorial_1.isActive,e=!0)},this.node),this.node.on("touchmove",function(t){var e=t.touch.getDelta();this.x+=e.x,this.y+=e.y},this.node),this.node.on("touchend",function(){},this.node)},start:function(){}}),cc._RF.pop()},{}],"use_v2.0.x_cc.Toggle_event":[function(t,e){"use strict";cc._RF.push(e,"f7811KgWW1DQqkapdCFBdRb","use_v2.0.x_cc.Toggle_event"),cc.Toggle&&(cc.Toggle._triggerEventInScript_check=!0),cc._RF.pop()},{}],utils:[function(t,e){"use strict";cc._RF.push(e,"8f0dei9/LdB9b4+M+5RK3bS","utils"),cc.Class({extends:cc.Component,properties:{outlinePrefab:{default:null,type:cc.Prefab},scoreDisplay:{default:null,type:cc.Label}},onLoad:function(){this.boundLeft=-this.node.width/2,this.boundBot=-this.node.height/2,this.gapX=this.node.width%this.outlinePrefab.data.width/2,this.gapY=this.node.height%this.outlinePrefab.data.height/2,this.outlinePool=new cc.NodePool,this.colCount=Math.floor(this.node.width/this.outlinePrefab.data.width),this.rowCount=Math.floor(this.node.height/this.outlinePrefab.data.height),this.totalScore=this.rowCount*this.colCount;for(var t=0;t<this.totalScore;t++){var e=cc.instantiate(this.outlinePrefab);this.outlinePool.put(e),this.createOutline(this.node,t)}this.score=0,this.scoreDisplay.zIndex=3,this.objCollection=[]},getCellPos:function(t,e){return cc.v2(this.gapX+this.boundLeft+this.outlinePrefab.data.width/2+this.outlinePrefab.data.width*(t-1),this.gapY+this.boundBot+this.outlinePrefab.data.height/2+this.outlinePrefab.data.height*(e-1))},createOutline:function(t,e){var i=null;(i=this.outlinePool.size()>0?this.outlinePool.get():cc.instantiate(this.outlinePrefab)).parent=t;var s=Math.floor(e/this.colCount),o=e;e>this.colCount-1&&(o=e-this.colCount*s),i.setPosition(this.getCellPos(o+1,s+1))},createObj:function(t,e,i,s,o){var n=cc.instantiate(i);return s.put(n),o&&(e=this.getCellPos(e.x,e.y)),(n=s.size()>0?s.get():cc.instantiate(i)).parent=t,n.setPosition(e),n.zIndex=1,this.objCollection.push(n),e},createObstacle:function(t,e,i,s,o){return this.totalScore-=1,this.createObj(t,e,i,s,o)},putObj:function(t,e,i,s,o,n){return this.createObj(t,e,i,s,!1),o.push(cc.v2(e.x,e.y)),this.score+=1,this.scoreDisplay.string="Score: "+this.score+"/"+this.totalScore,null!=n&&n.updateCapturedCell(),this.score},checkCollapsed:function(t,e,i){return t.node.position.sub(e.getPosition()).mag()<i},start:function(){}}),cc._RF.pop()},{}],win:[function(t,e){"use strict";cc._RF.push(e,"fd775mVDYRNwYD3xdD4elDw","win"),cc.Class({extends:cc.Component,properties:{scoreDisplay:{default:null,type:cc.Label}},onLoad:function(){var t=cc.find("background");this.scoreDisplay.string="SCORE: "+t.score+"/"+t.totalScore},start:function(){}}),cc._RF.pop()},{}]},{},["character","continue_button","gameover","sound_lib","sound_lib_ts","stage_01","stage_02","stage_03","stage_04","stage_05","stage_06","try_again_button","tutorial_button","utils","win","use_v2.0.x_cc.Toggle_event"]);
//# sourceMappingURL=index.js.map
